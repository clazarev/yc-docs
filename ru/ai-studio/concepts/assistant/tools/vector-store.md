---
title: Инструмент Retrieval в {{ assistant-api }}
description: В данном разделе вы узнаете об инструменте Retrieval {{ assistant-api }}, с помощью которого вы можете создавать персонализированных ассистентов, реализующих сценарий генеративного ответа с учетом информации из поисковых индексов.
---

# Инструмент Retrieval

Инструмент Retrieval позволяет AI-ассистенту искать информацию для ответа в ваших файлах (базе знаний). При работе с инструментом Retrieval вы можете использовать специально обученную [модель перефразирования](../rephraser.md) запросов пользователей, чтобы повысить качество поиска.

Чтобы AI-ассистент мог использовать вашу базу знаний:

1. Загрузите [файлы](../files.md) базы знаний с помощью API или {{ ml-sdk-name }}.
1. Создайте [поисковый индекс](../search-index.md) для файлов. После этого вы можете удалить загруженные файлы, если ссылки на источники вам не нужны.
1. Подключите поисковый индекс к ассистенту. Вы можете включить отображение [ссылок на источники](../files.md#citations), если файлы поискового индекса не удалены.
1. Если нужно, [настройте](../../../operations/assistant/create-with-searchindex.md) стратегию обращения к поисковым индексам, чтобы ассистент обращался к ним только тогда, когда это действительно необходимо.
1. Если нужно, [включите](../../../operations/assistant/rephraser.md) модель перефразирования как дополнительный слой ассистента.

{% include [rag-default-strategy-paragraph](../../../../_includes/ai-studio/assistants/rag-default-strategy-paragraph.md) %}

Вместе с тем обращаться к поисковому индексу при ответе на запрос пользователя AI-ассистенту требуется далеко не всегда — для ответов на многие вопросы достаточно базовой информации, имеющейся у модели. При настройке ассистента вы можете задать _стратегию обращения к инструменту Retrieval_, чтобы модель ассистента самостоятельно определяла, когда необходимо использовать индекс для поиска информации.

Чтобы AI-ассистент мог использовать инструмент Retrieval со стратегией обращения к этому инструменту:

{% list tabs group=programming_language %}

- SDK {#sdk}

  В [{{ ml-sdk-name }}](../../../sdk/index.md) передайте инструкцию для модели по обращению к поисковому индексу в параметре `call_strategy` при создании инструмента Retrieval. Затем при создании AI-ассистента передайте полученный объект с инструментом Retrieval в параметре `tools`.

  ```python
  ...
  tool = sdk.tools.search_index(
      search_index,
      call_strategy={
          "type": "function",
          "function": {"name": "search-function-name", "instruction": "<инструкция_по_использованию_поиска>"},
      },
  )

  assistant = sdk.assistants.create(
      "yandexgpt", 
      instruction = "Ты — помощник по внутренней документации компании. Отвечай вежливо. Если информация не содержится в документах ниже, не придумывай ответ.", 
      tools=[tool])
  thread = sdk.threads.create()
  ...
  ```

- cURL {#curl}

  В [API](../../api.md) при [создании](../../../assistants/api-ref/Assistant/create.md) или [изменении](../../../assistants/api-ref/Assistant/update.md) AI-ассистента передайте инструкцию для модели по обращению к поисковому индексу в массиве `tools` тела запроса в объекте `callStrategy`.

  ```json
  {
    ...
    "tools": [
      {
        "searchIndex": {
          "searchIndexIds": [
            "<идентификатор_поискового_индекса>"
          ],
          "maxNumResults": "<максимальное_число_возвращаемых_фрагментов>",
          "callStrategy": {
            "autoCall": {
              "instruction": "<инструкция_по_использованию_поиска>"
            }
          }
        }
      }
    ]
  }
  ```

  Где:
  * `searchIndexIds` — массив идентификаторов [поисковых индексов](../search-index.md), которые будет использовать ассистент. В настоящее время можно указать только один индекс.
  * `maxNumResults` — максимальное количество результатов, которое может вернуть поиск.
  * `instruction` — инструкция по использованию поиска с подсказкой для ассистента, в каких случаях требуется обращаться к поисковому индексу.

{% endlist %}

Инструкция по использованию поиска, заданная в стратегии, представляет собой [промт](../../index.md#prompt), который подсказывает ассистенту, в каких случаях требуется обращаться к поисковому индексу. Например:

```json
"instruction": "Выполняй поиск по базе знаний только в тех случаях, когда пользователь тебя специально об этом попросит."
```

#### См. также {#see-also}

* [{#T}](../files.md)
* [{#T}](../search-index.md)
* [{#T}](../rephraser.md)
* [{#T}](../../../operations/assistant/create-with-searchindex.md)
* [{#T}](./web-search.md)