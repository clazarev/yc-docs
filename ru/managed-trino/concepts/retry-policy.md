# Отказоустойчивое выполнение запросов в кластере {{ mtr-name }}

Отказоустойчивое выполнение запросов в кластере {{ mtr-name }} обеспечивается механизмом [Fault tolerant execution](https://trino.io/docs/current/admin/fault-tolerant-execution.html). По умолчанию при недостатке ресурсов или ошибке при выполнении запроса [воркер](index.md#workers) прекращает его обработку. Такой запрос нужно перезапустить вручную. При включении Fault tolerant execution запрос или промежуточное задание в составе запроса будут выполнены повторно в случае сбоя.

Чтобы обеспечить отказоустойчивое выполнение запросов при включенном Fault tolerant execution, Exchange Manager периодически выгружает промежуточные результаты в служебный бакет {{ objstorage-name }}. Если запрос не был выполнен, то [координатор](index.md#coordinator) назначит повторное выполнение запроса другому воркеру, который сможет использовать ранее обработанные данные.

{% note info %}

Механизм Fault tolerant execution не распространяется на ошибочные или некорректно составленные запросы.

{% endnote %}

Механизм Fault tolerant execution поддерживается только для следующих [коннекторов](index.md#connector):

{% include [connectors](../../_includes/managed-trino/retry-policy-connector-list.md) %}

Чтобы включить Fault tolerant execution, при [создании](../operations/cluster-create.md) или [изменении](../operations/cluster-update.md#change-retry-policy) кластера выберите в блоке **Политика перезапросов** значение параметра **Тип объекта для перезапроса**:

* **Задача** — в рамках запроса повторно выполняется промежуточное задание, вызвавшее сбой воркера.

   {% note warning %}

   При интенсивном потоке простых запросов повторный запуск заданий может привести к более высокой задержке сложных пакетных запросов. Рекомендуется создать выделенный кластер {{ mtr-name }} с настройкой повторного выполнения заданий для сложных пакетных запросов.

   {% endnote %}

* **Запрос** — повторно выполняются все [этапы запроса](index.md#query-execution), в котором произошел сбой воркера.

Подробнее об отказоустойчивом выполнении запросов см. в [официальной документации](https://trino.io/docs/current/admin/fault-tolerant-execution.html).
