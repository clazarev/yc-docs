# Работа с сохраненными запросами

Любой запрос может быть [сохранен](../concepts/index.md#saved-queries) для дальнейшего использования и создания шаблона. В разделе ![image](../../_assets/console-icons/floppy-disk.svg) **Сохраненные запросы** вы можете:

   * [сохранить запрос в качестве шаблона](#save-query);
   * [использовать сохраненный запрос](#use-templates);
   * [изменить сохраненный запрос](#alter-template);
   * [опубликовать сохраненный запрос](#publish-query);
   * [настроить права доступа для опубликованного запроса](#set-access-rights-to-published-query);
   * [удалить сохраненный запрос](#remove-query);

## Сохранить запрос в качестве шаблона {#save-query}

Чтобы сохранить запрос:

{% list tabs %}

- Редактор запросов

   1. В разделе ![image](../../_assets/console-icons/folder-tree.svg) [**Подключения**]({{ websql-link }}) подключитесь к нужной БД и [перейдите в редактор запросов](query-executor.md).
   1. На панели данных нажмите ![image](../../_assets/console-icons/floppy-disk.svg) рядом с кнопкой **Выполнить**.
   1. В окне **Сохранение запроса**:
      1. Выберите БД, к которой осуществляется запрос. По умолчанию в этом поле указана текущая БД.
      1. Укажите **Название** — произвольное имя запроса, под которым он будет отображаться в списке сохраненных запросов.
      1. Для того чтобы сохраненный запрос мог использоваться в качестве шаблона в списке-подсказке, выберите опцию **Добавить подсказку** и укажите **Текст подсказки**, содержащий `userTemplate_`.

         {% note tip %}

         Если добавляете подсказку и указываете имя шаблона, то в запросе можно указать аргументы, которые будут подсвечиваться при выборе этого шаблона, например: `SELECT $1 FROM employees LIMIT $2`.

         {% endnote %}

      1. Проверьте или отредактируйте запрос.
      1. Нажмите кнопку **Сохранить**.

- Раздел Сохраненные запросы

   1. Откройте сервис [{{ websql-full-name }}]({{ websql-link }}).
   1. Перейдите в раздел ![image](../../_assets/console-icons/floppy-disk.svg) **Сохраненные запросы**.
   1. В правом верхнем углу раздела нажмите ![image](../../_assets/websql/new-connection.svg).
   1. В открывшемся окне:

      1. Выберите подключение к БД, к которой осуществляется запрос.
      1. Укажите **Название** — произвольное имя запроса, под которым он будет отображаться в списке сохраненных запросов.
      1. Для того чтобы сохраненный запрос мог использоваться в качестве шаблона в списке-подсказке, выберите опцию **Добавить подсказку** и укажите **Текст подсказки**, содержащий `userTemplate_`.

         {% note tip %}

         Если добавляете подсказку и указываете имя шаблона, то в запросе можно указать аргументы, которые будут подсвечиваться при выборе этого шаблона, например: `SELECT $1 FROM employees LIMIT $2`.

         {% endnote %}

      1. Задайте текст запроса.
      1. Нажмите кнопку **Сохранить**.

{% endlist %}

После сохранения запроса он отобразится в окне ![image](../../_assets/console-icons/floppy-disk.svg) **Сохраненные запросы**. Если вы добавили подсказку, он будет показываться как шаблон вместе с [готовыми шаблонами](#use-templates) {{ websql-full-name }}.

## Использовать сохраненный запрос {#use-templates}

{% list tabs %}

- Редактор запросов

   1. Начните печатать `template` в поле запроса.
   В списке-подсказке вы увидите сохраненные шаблоны `userTemplate_*` и заготовленные шаблоны:

      * `template_CREATE`;
      * `template_DELETE`;
      * `template_DROP_TABLE`;
      * `template_INSERT`;
      * `template_SELECT`;
      * `template_UPDATE`.

   1. Выберите шаблон из списка-подсказки.
   1. Дополните шаблон релевантными параметрами. Используйте клавишу `TAB`, чтобы переключаться между дополняемыми частями шаблона.
   1. Нажмите кнопку **Выполнить**.

- Раздел Сохраненные запросы

   1. Перейдите в раздел ![image](../../_assets/console-icons/floppy-disk.svg) **Сохраненные запросы**.
   1. Нажмите ![image](../../_assets/console-icons/ellipsis.svg) справа от нужного запроса и выберите **Использовать запрос** — он отобразится в панели данных.
   1. Нажмите кнопку **Открыть в редакторе**.
   1. (Опционально) Измените параметры запроса.
   1. Нажмите кнопку **Выполнить**.

{% endlist %}

## Изменить сохраненный запрос {#alter-template}

Чтобы изменить сохраненный запрос:

1. Перейдите в раздел ![image](../../_assets/console-icons/floppy-disk.svg) **Сохраненные запросы**.

1. Нажмите ![image](../../_assets/console-icons/ellipsis.svg) справа от нужного запроса и выберите **Изменить запрос**.

1. В открывшемся окне:

   1. Выберите БД, к которой осуществляется запрос.
   1. Укажите **Название** — произвольное имя запроса, под которым он будет отображаться в списке сохраненных запросов.
   1. Добавьте подсказку, измените ее текст или удалите подсказку.

      {% note tip %}

      Если добавляете подсказку и указываете имя шаблона, то в запросе можно указать аргументы, которые будут подсвечиваться при выборе этого шаблона, например: `SELECT $1 FROM employees LIMIT $2`.

      {% endnote %}

   1. Проверьте или отредактируйте запрос.

1. Нажмите кнопку **Сохранить**.

## Опубликовать запрос {#publish-query}

Вы можете опубликовать свой запрос. После публикации запрос будет доступен всем пользователям каталога. Публикацию запроса нельзя отменить.

Чтобы опубликовать запрос:

1. Перейдите в раздел ![image](../../_assets/console-icons/floppy-disk.svg) **Сохраненные запросы**.

1. Нажмите ![image](../../_assets/console-icons/ellipsis.svg) справа от нужного запроса и выберите **Опубликовать запрос**.

1. В открывшемся окне нажмите кнопку **Опубликовать**.

Рядом с названием опубликованного запроса отображается значок ![image](../../_assets/console-icons/lock-open.svg).

## Настроить права доступа для опубликованного запроса {#set-access-rights-to-published-query}

Чтобы настроить [права доступа](../security/index.md):

1. Перейдите в раздел ![image](../../_assets/console-icons/floppy-disk.svg) **Сохраненные запросы**.

1. Нажмите ![image](../../_assets/console-icons/ellipsis.svg) справа от нужного запроса и выберите **Права доступа**.

1. В открывшемся окне нажмите **Назначить роли**.

1. Задайте нужные роли и нажмите кнопку **Сохранить**.

## Удалить сохраненный запрос {#remove-template}

Чтобы удалить сохраненный запрос:

1. Перейдите в раздел ![image](../../_assets/console-icons/floppy-disk.svg) **Сохраненные запросы**.

1. Нажмите ![image](../../_assets/console-icons/ellipsis.svg) справа от нужного запроса и выберите **Удалить**.

1. В открывшемся окне нажмите кнопку **Применить**.
